# Building
On linux or macos first install the [emscripten sdk](https://emscripten.org/docs/getting_started/downloads.html) to your users home directory `~/emsdk`  
So you should have `/home/your_user/emsdk/emsdk_env.sh` file.  
And then run:
```
./bindings/js/configure.sh
./bindings/js/build.sh
```
on windows or if emscripten sdk is in different location check the above scripts and run the apropriate commands manually.  

The output files are in the root build directory (depthai-core/build):
```
build/bindings/js/depthai-js.js
build/bindings/js/depthai-js.wasm
build/bindings/js/depthai-js.d.ts
```
  
If something fails delete the build folder or the build folder and the ~/.hunter folder (maybe only the cache folder inside).

# Usage
Check out the [bindings/js/example folder](example/).

# Typescript support
There are autogenerated bindings available in `build/bindings/js/depthai-js.d.ts`

# Future directions
- Maybe add automatic bindings generation using [SWIG's](https://github.com/swig/swig) new wasm and typescript support or using a [custom SWIG language](https://www.swig.org/Doc4.0/Extending.html) to have more freedom / better quality bindings / same swig headers for javascript and python :). New SWIG wasm and typescript support: (https://github.com/mmomtchev/magickwand.js) - (https://mmomtchev.medium.com/effortlessly-porting-a-major-c-library-to-node-js-with-swig-napi-3c1a5c4a233f) . SWIG could then also be used to generate the python bindings in the long run.
- Also support node.js via a native compiled module (better / faster / more functionality (discover packets can be sent...)) or / and WASM module (easier user installation)(is already supported / can be same as the browser one)
- add [npm](https://www.npmjs.com/) support.
- Talk about how to expose all the depthai functions and classes so we don't have memory problems (users don't have to call `obj.delete()` from javascript) and they are nice to use from typescript and javascript.
- Convert from C++ `std::vector<std::uint8_t>` to javascript `Uint8Array` type with zero memory copy using a pointer, the emscripten [HEAP](https://emscripten.org/docs/api_reference/preamble.js.html?highlight=heapu8#type-accessors-for-the-memory-model) and some wrappers. [Example ideas](https://stackoverflow.com/questions/53602955/using-emscripten-how-to-get-c-uint8-t-array-to-js-blob-or-uint8array). But we should first define how we wil be exposing the depthai functions and classes and if we will be using SWIG or not.
- Maybe define a generic `deserialize` function that check the type and returns a custom (depending on C++ class) built `emscripten::val` (this should use code generation to find the C++ types properties...). This would be nice, but we loose embind C++ classes mapping and have to do our own and it wouldn't be nice to use from typescript.
